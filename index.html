<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="stylesheet" href="node_modules/onsenui/css/onsenui.css"/>
    <link rel="stylesheet" href="node_modules/onsenui/css/onsen-css-components.css"/>

    <script src="node_modules/onsenui/js/onsenui.js"></script>
    <script src="node_modules/jquery/dist/jquery.js"></script>

    <link rel="apple-touch-startup-image" href="https://previews.123rf.com/images/photobizz/photobizz1211/photobizz121100024/16428232-Forrest-in-autumn-and-sunlight-Stock-Photo.jpg">

    <title>StandsOnCampus</title>

    <!-- set the viewport-->
    <meta name="viewport" content = "width = device-width, initial-scale = 1.0, minimum-scale = 1, maximum-scale = 1, user-scalable = no" />
    <meta charset="utf-8">

    <!--Fullscreen mode  http://www.onlywebpro.com/2015/07/19/optimizing-full-screen-mobile-web-app-for-ios/ -->
    <meta name="apple-mobile-web-app-capable" content="yes">

    <!--black status bar-->
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />

    <!--Launcher icon-->
    <link rel="apple-touch-icon" href="apple-touch-icon-iphone.png">
    <link rel="apple-touch-icon" sizes="76x76" href="touch-icon-ipad.png">
    <link rel="apple-touch-icon" sizes="120x120" href="touch-icon-iphone-retina.png">
    <link rel="apple-touch-icon" sizes="152x152" href="touch-icon-ipad-retina.png">'


    <!-- Startup image code-->
    <link rel="apple-touch-startup-image" href="iphone-startup.png">
    <link rel="apple-touch-startup-image" href="ipad-landscape-startup.png" media="screen and (min-device-width: 481px) and (max-device-width: 1024px) and (orientation:landscape)" />
    <link rel="apple-touch-startup-image" href="ipad-portrait-startup.png" media="screen and (min-device-width: 481px) and (max-device-width: 1024px) and (orientation:portrait)" />
  </script>
<style>
/* Always set the map height explicitly to define the size of the div
 * element that contains the map. */
 @media (display-mode: fullscreen) {
 }
#map {
  height: 100%;
  width:100%
}
/* Optional: Makes the sample page fill the window. */
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
}

/* Always set the map height explicitly to define the size of the div
 * element that contains the map. */
 @media (display-mode: fullscreen) {
 }
#map {
  height: 100%;
  width:100%
}
/* Optional: Makes the sample page fill the window. */
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
}
#title {
   padding: 5px;
   border: none;
   border-bottom: 1px solid lightgray;
   width: 95%;
   font-size: 1.5em;
 }
 #description {
   padding-left: 10px;
   padding-right: 10px;
   border: none;
   width:95%;
   font-family: sans-serif;
   font-size: 1.3em;
   height:auto;
   overflow: scroll;
  }
  p{
    font-size:1.2em;
  }
</style>
</head>
<body>

<ons-navigator  id="myNavigator" page="map-page"></ons-navigator>
<ons-template id="form-page">
  <ons-toolbar>
  <ons-back-button type="button" id="cancelButton">
  Back
  </ons-toolbar>
<div style="text-align: center; margin-top: 30px;">
      <div id="form"style="text-align: center; margin-top: 30px;">
      <input id="title" placeholder="Title"></input>
      <br>
      <textarea id="description" rows="5" cols="80" placeholder="Event description"></textarea>
  </div>
  </div>

  <ons-list>
    <ons-list-item tappable>
      <label class="left">
        <ons-input type="checkbox" input-id="coffee" ></ons-input>
      </label>
      <label for="check-1" class="center">
        Coffee
      </label>
    </ons-list-item>
    <ons-list-item tappable>
      <label class="left">
        <ons-input type="checkbox" input-id="snack" ></ons-input>
      </label>
      <label for="check-2" class="center">
        Snack
      </label>
    </ons-list-item>
    <ons-button  modifier="large" type="button" onclick="getLocation()">Create Event</ons-button>
  </ons-list>
    </ons-template>

<ons-template id="map-page">
    <div id="map">
      </div>
<ons-fab ripple style="position: absolute;bottom: 60px;right: 40px;" id="createEventButton" onclick="myNavigator.pushPage('form-page');">
  <ons-icon
    icon="md-plus">
  </ons-icon>
</ons-fab>
</ons-template>
    <script>

    document.addEventListener('deviceready', function() {
        StatusBar.overlaysWebView(false);
        StatusBar.backgroundColorByName('green');
    }, false);

var x = document.getElementById("map");
var formInfo = {}

// -GET MY POSITION FuNCTION
function getLocation() {
  if (document.getElementById('title').value == "") {
    document.getElementById("title").placeholder = "Title is required*";
    //HOW TO CHANGE placeholder COLOR TO RED???
    //document.getElementById("title").style.color = "green";
    return; }
    //go back to map page
  myNavigator.popPage();
  var title = document.getElementById('title').value;
  var description = document.getElementById('description').value;
  if ($('#coffee').prop('checked') == true) {
    var coffee = "<h4><ons-icon icon='coffee'></ons-icon> Coffee</h4>";
  }else{
    var coffee = "";
  };
  if ($('#snack').prop('checked') == true) {
    var snack = "<h4><ons-icon icon='ion-android-checkbox'></ons-icon> Snack</h4>";
  }else{
    var snack = "";
  };
  formInfo = {"title":title, "description":description, "coffee":coffee, "snack":snack}
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(createEventMarker);
    } else {
        x.innerHTML = "Geolocation is not supported by this browser.";
    }
  }
function createEventMarker(position) {
  markerEventPosition = new google.maps.Marker({
    map: map,
    draggable: false,
    animation: google.maps.Animation.DROP,
    position: {lat: position.coords.latitude, lng: position.coords.longitude},
    title:"Event"
    });
   map.setCenter({lat: position.coords.latitude, lng: position.coords.longitude} );
   markerEventPosition.addListener('click', function(){
     var contentString =
     '<h3 >'+ formInfo["title"] +'</h3>'+
     '<p>'+ formInfo["description"] + '</p>' +
     formInfo['coffee'] +
     formInfo['snack'] +
     '</div>';
     var infowindow = new google.maps.InfoWindow({
       content: contentString
       });
       infowindow.open(map, markerEventPosition);
     });
   }
      // Google Map
      var map;
      // Constructor
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: 59.347106, lng: 18.071965},
          zoom: 17,
          mapTypeId: 'hybrid',
          tilt:45,
          zoomControl: false,
          mapTypeControl: false,
          scaleControl: false,
          streetViewControl: false,
          rotateControl: false,
          fullscreenControl: false
        });
      }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBYWmQkeSCXE_Po-9UELcOHc0MHSd8kPuI&callback=initMap"
    async defer></script>
  </body>
</html>
